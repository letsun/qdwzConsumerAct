webpackJsonp([17],{Syjv:function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=t("Gu7T"),r=t.n(s),o=t("GQaK"),a=t("OUXH"),c=t("wzPG"),n=t("7AG+"),l=t("RoWd"),v=t("d1wj"),h=(t("yt7g"),t("CyOZ"),t("zSeF")),d=t("N183"),m=t("i5La"),p=t.n(m),u={components:{NavHeader:a.a,ModelWin:c.a,LoadingPage:n.a,LoadingTip:l.a,VuePickers:p.a},data:function(){return{errorTip:"",showModel:!1,isConfirm:!1,okType:"",isLoadCompleted:!0,lotteryRecordList:[],pageSize:1,loadingTip:"上滑加载更多",limit:20,hasNext:!0,receiveName:"",receivePhone:"",receiveAddress:"",receiveProvince:"省",receiveCity:"市",receiveArea:"区",isShowArea:!0,isShowCity:!0,showPicker1:!1,showPicker2:!1,showPicker3:!1,pickData1:{columns:1,default:{text:"请选择",value:""},pData1:d.a},pickData2:{columns:1,default:{text:"请选择",value:""},pData1:[{text:"请选择",value:""}]},pickData3:{columns:1,default:{text:"请选择",value:""},pData1:[{text:"请选择",value:""}]},isSubmitShow:!1,prizeName:"",lotteryRecordId:"",index:""}},mounted:function(){var e=this;this.$nextTick(function(){$("body").show(),e.getWining(),e.initScroll()})},computed:{getHeaders:function(){return this.$store.getters.getHeaders}},updated:function(){this.finish()},methods:{initScroll:function(){var e=this;this.scroll=new o.a(this.$refs.scrollWrapper,{scrollbar:{fade:!0},click:!0,pullUpLoad:{threshold:0}}),this.scroll.on("pullingUp",function(){e.hasNext?(e.pageSize++,e.loadingTip="数据正在加载中....",e.getWining()):e.loadingTip="已经没有更多了"})},getWining:function(){var e=this;this.$http.get(v.a.lottery.record,{headers:this.getHeaders,params:{pageNum:this.pageSize,pageSize:this.limit}}).then(function(i){var t=i.data;t.code===h.a.SUCCESS&&(e.hasNext=t.data.hasNext,e.loadingTip="上滑加载更多",e.isLoadCompleted=!0,e.lotteryRecordList=[].concat(r()(e.lotteryRecordList),r()(t.data.list)))})},finish:function(){this.scroll.finishPullUp(),this.scroll.refresh()},selectProvince:function(){this.inputBlur(),this.showPicker1=!0},selectCity:function(){this.inputBlur(),this.showPicker2=!0},selectArea:function(){this.inputBlur(),this.showPicker3=!0},confirmFn1:function(e){this.showPicker1=!1,void 0!==e.select1.sub?(this.pickData2.pData1=e.select1.sub,this.isShowCity=!0,this.isShowArea=!0):(this.isShowCity=!1,this.isShowArea=!1),this.receiveProvince=e.select1.text,this.receiveCity="请选择市",this.receiveArea="请选择区"},confirmFn2:function(e){this.showPicker2=!1,void 0!==e.select1.sub?(this.pickData3.pData1=e.select1.sub,this.isShowArea=!0):this.isShowArea=!1,this.receiveCity=e.select1.text,this.receiveArea="请选择区"},confirmFn3:function(e){this.showPicker3=!1,this.receiveArea=e.select1.text},closeFn:function(){this.showPicker1=!1,this.showPicker2=!1,this.showPicker3=!1},inputBlur:function(){for(var e=this.$refs.formList.getElementsByTagName("input"),i=0,t=e.length;i<t;i++)e[i].blur()},submitInfo:function(){var e=this;return this.receiveName?this.receivePhone?/^1[0-9]{10}$/.test(this.receivePhone)?"省"===this.receiveProvince||"请选择"===this.receiveProvince?(this.showModel=!0,this.isConfirm=!1,void(this.errorTip="收货人省份不能为空")):"市"===this.receiveCity||"请选择"===this.receiveCity?(this.showModel=!0,this.isConfirm=!1,void(this.errorTip="收货人城市不能为空")):!this.isShowArea||"区"!==this.receiveArea&&"请选择"!==this.receiveArea?this.receiveAddress?("请选择区"==this.receiveArea&&(this.receiveArea=""),this.isLoadingShow=!0,void this.$http.get(v.a.lottery.save,{headers:this.getHeaders,params:{lotteryRecordId:this.lotteryRecordId,receiveName:this.receiveName,receivePhone:this.receivePhone,receiveProvince:this.receiveProvince,receiveCity:this.receiveCity,receiveArea:this.receiveArea,receiveAddress:this.receiveAddress}}).then(function(i){e.isLoadingShow=!1,e.isSubmitShow=!1;var t=i.data;t.code===h.a.SUCCESS?(e.lotteryRecordList[e.index].status=1,e.showModel=!0,e.isConfirm=!1,e.errorTip="提交成功",e.receiveName="",e.receivePhone="",e.receiveProvince="",e.receiveCity="",e.receiveArea="",e.receiveAddress="",e.lotteryRecordId="",e.index=""):(e.showModel=!0,e.isConfirm=!1,e.errorTip=t.msg)})):(this.showModel=!0,this.isConfirm=!1,void(this.errorTip="收货人地址不能为空")):(this.showModel=!0,this.isConfirm=!1,void(this.errorTip="收货人地区不能为空")):(this.showModel=!0,this.isConfirm=!1,void(this.errorTip="收货人电话格式有误")):(this.showModel=!0,this.isConfirm=!1,void(this.errorTip="收货人电话不能为空")):(this.showModel=!0,this.isConfirm=!1,void(this.errorTip="收货人姓名不能为空"))},closeModelWin:function(){this.isConfirm=!1,this.showModel=!1},okModelWin:function(e,i){e(i)},receiveFunc:function(e,i){this.index=i,this.prizeName=e.prizeName,this.lotteryRecordId=e.id,this.isSubmitShow=!0}}},f={render:function(){var e=this,i=e.$createElement,t=e._self._c||i;return t("div",[t("nav-header",{attrs:{back:"true",color:"0"}},[t("div",{staticClass:"title",attrs:{slot:"title"},slot:"title"},[e._v("中奖记录")])]),e._v(" "),t("div",{staticClass:"container"},[t("div",{ref:"scrollWrapper",staticClass:"scroll-wrapper"},[t("div",{staticClass:"wrapper"},[e._m(0),e._v(" "),t("div",{staticClass:"list"},e._l(e.lotteryRecordList,function(i,s){return t("div",{key:s,staticClass:"item"},[t("div",{staticClass:"child-item child-item1"},[e._v(e._s(0==i.prizeType?"积分奖励":i.prizeName))]),e._v(" "),t("div",{staticClass:"child-item child-item2"},[e._v(e._s(0==i.prizeType?i.prizeName:i.prizeContent))]),e._v(" "),t("div",{staticClass:"child-item child-item3"},[e._v(e._s(i.createDateStr))]),e._v(" "),t("div",{staticClass:"child-item child-item4",class:{active:"0"==i.status},on:{click:function(t){e.receiveFunc(i,s)}}},[e._v(e._s(0==i.status?"继续领取":"已领取"))])])})),e._v(" "),t("loading-tip",{attrs:{loadingTip:e.loadingTip,isShow:e.lotteryRecordList.length>=e.limit,hasNext:e.hasNext}})],1)])]),e._v(" "),e.isSubmitShow?t("div",{staticClass:"submit-info"},[t("div",{staticClass:"submit-content"},[t("div",{staticClass:"submit-title"},[e._v(e._s(e.prizeName))]),e._v(" "),t("div",{ref:"formList",staticClass:"form"},[t("div",{staticClass:"form-item"},[t("div",{staticClass:"form-key"},[e._v("姓   名")]),e._v(" "),t("div",{staticClass:"form-val"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.receiveName,expression:"receiveName"}],attrs:{type:"text",maxlength:"20",placeholder:"请填写您的姓名"},domProps:{value:e.receiveName},on:{input:function(i){i.target.composing||(e.receiveName=i.target.value)}}})])]),e._v(" "),t("div",{staticClass:"form-item"},[t("div",{staticClass:"form-key"},[e._v("手机号")]),e._v(" "),t("div",{staticClass:"form-val"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.receivePhone,expression:"receivePhone"}],attrs:{type:"text",maxlength:"11",placeholder:"请填写您的手机号码"},domProps:{value:e.receivePhone},on:{input:function(i){i.target.composing||(e.receivePhone=i.target.value)}}})])]),e._v(" "),t("div",{staticClass:"form-item"},[t("div",{staticClass:"form-key"},[e._v("区   域")]),e._v(" "),t("div",{staticClass:"form-val form-select-val"},[t("div",{staticClass:"item",on:{click:function(i){return i.stopPropagation(),e.selectProvince(i)}}},[e._v(e._s(e.receiveProvince))]),e._v(" "),e.isShowCity?t("div",{staticClass:"item",on:{click:function(i){return i.stopPropagation(),e.selectCity(i)}}},[e._v(e._s(e.receiveCity))]):e._e(),e._v(" "),e.isShowArea?t("div",{staticClass:"item",on:{click:function(i){return i.stopPropagation(),e.selectArea(i)}}},[e._v(e._s(e.receiveArea))]):e._e()])]),e._v(" "),t("div",{staticClass:"form-item"},[t("div",{staticClass:"form-key"},[e._v("地   址")]),e._v(" "),t("div",{staticClass:"form-val"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.receiveAddress,expression:"receiveAddress"}],attrs:{type:"text",maxlength:"50",placeholder:"请填写您的详细地址"},domProps:{value:e.receiveAddress},on:{input:function(i){i.target.composing||(e.receiveAddress=i.target.value)}}})])])]),e._v(" "),t("div",{staticClass:"submit-btn",on:{click:function(i){e.submitInfo()}}},[e._v("提交")])])]):e._e(),e._v(" "),t("model-win",{attrs:{show:e.showModel}},[t("template",{slot:"content"},[e._v("\n            "+e._s(e.errorTip)+"\n        ")]),e._v(" "),t("template",{slot:"btn"},[e.isConfirm?[t("a",{staticClass:"btn",attrs:{href:"javascript:void(0);"},on:{click:e.closeModelWin}},[e._v("取消")]),e._v(" "),t("a",{staticClass:"btn btn-last",attrs:{href:"javascript:void(0);"},on:{click:function(i){e.okModelWin(e.okType,e.param)}}},[e._v("确定")])]:[t("a",{staticClass:"btn",attrs:{href:"javascript:void(0);"},on:{click:e.closeModelWin}},[e._v("确定")])]],2)],2),e._v(" "),t("transition",{attrs:{name:"fade"}},[e.isLoadCompleted?e._e():t("loading-page",{attrs:{page:"noTop"}})],1),e._v(" "),t("vue-pickers",{attrs:{show:e.showPicker1,selectData:e.pickData1},on:{cancel:e.closeFn,confirm:e.confirmFn1}}),e._v(" "),t("vue-pickers",{attrs:{show:e.showPicker2,selectData:e.pickData2},on:{cancel:e.closeFn,confirm:e.confirmFn2}}),e._v(" "),t("vue-pickers",{attrs:{show:e.showPicker3,selectData:e.pickData3},on:{cancel:e.closeFn,confirm:e.confirmFn3}})],1)},staticRenderFns:[function(){var e=this.$createElement,i=this._self._c||e;return i("div",{staticClass:"title"},[i("div",{staticClass:"title-item title-item1"},[this._v("中奖类型")]),this._v(" "),i("div",{staticClass:"title-item title-item2"},[this._v("奖品")]),this._v(" "),i("div",{staticClass:"title-item  title-item3"},[this._v("中奖时间")]),this._v(" "),i("div",{staticClass:"title-item  title-item4"},[this._v("领取状态")])])}]};var C=t("VU/8")(u,f,!1,function(e){t("X4KR")},"data-v-32acd54c",null);i.default=C.exports},X4KR:function(e,i){}});